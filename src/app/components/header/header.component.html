<header class="header">
  <div class="header-container">
    <div class="logo">
      <a routerLink="/">
        <img src="/assets/logo.png" alt="logo" class="brand-logo" />
        <span class="brand-title">{{ appName }}</span>
      </a>
    </div>
    <div class="nav-icons">
      <button class="icon-btn search-btn" (click)="openSearch()" title="Search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
      </button>
      
      <!-- Show profile picture if user is logged in, otherwise show login icon -->
      @if (currentUser()) {
        <div class="user-profile" [title]="(userRole() === 'admin' ? 'Admin: ' : 'User: ') + (currentUser()?.displayName || currentUser()?.email)">
          <img 
            [src]="currentUser()?.photoURL || 'https://ui-avatars.com/api/?name=' + (currentUser()?.displayName || currentUser()?.email || 'User') + '&background=667eea&color=fff&size=200'" 
            [alt]="currentUser()?.displayName || (userRole() === 'admin' ? 'Admin' : 'User')"
            class="profile-picture"
            [class.admin-badge]="userRole() === 'admin'"
            (click)="openProfile()"
            (error)="handleImageError($event)"
            [title]="userRole() === 'admin' ? 'ðŸ‘‘ Admin - View profile' : 'View profile'"
          />
          @if (userRole() === 'admin') {
            <span class="role-badge">Admin</span>
          }
        </div>
      } @else {
        <button class="icon-btn login-btn" (click)="onLoginClick()" title="Login">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
            <polyline points="10 17 15 12 10 7"></polyline>
            <line x1="15" y1="12" x2="3" y2="12"></line>
          </svg>
        </button>
      }
    </div>
  </div>
</header>

<app-search-modal *ngIf="isSearchOpen" (close)="closeSearch()" (searchSubmit)="handleSearch($event)"></app-search-modal>

<app-login-modal *ngIf="isLoginOpen" (close)="closeLogin()"></app-login-modal>
